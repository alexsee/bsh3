<winex:WindowEx
    x:Class="BSH.MainApp.Windows.FilterWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:winex="using:WinUIEx"
    xmlns:viewmodels="using:BSH.MainApp.ViewModels.Windows"
    d:DataContext="{d:DesignInstance Type=viewmodels:FilterViewModel}"
    mc:Ignorable="d"
    Title="Exclude items"
    Height="650"
    Width="850"
    IsResizable="True"
    IsMaximizable="False"
    IsMinimizable="False"
    IsAlwaysOnTop="True">

    <Grid Background="White">
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <SelectorBar Grid.Row="0" Margin="16">
            <SelectorBarItem Text="Folders" HorizontalContentAlignment="Stretch">
                <Grid Padding="8" RowSpacing="12">
					<Grid.RowDefinitions>
						<RowDefinition Height="*" />
						<RowDefinition />
						<RowDefinition Height="*" />
					</Grid.RowDefinitions>
                    <TextBlock Grid.Row="0" Foreground="Gray" TextWrapping="Wrap">Exclude complete folders from your backup.</TextBlock>
                    <ListView Grid.Row="1"
                            ItemsSource="{x:Bind ViewModel.ExcludeFolders, Mode=OneWay}"
                            SelectedItem="{x:Bind ViewModel.SelectedFolder, Mode=TwoWay}">
                        <ListView.Header>
                            <TextBlock FontWeight="Bold">Folder</TextBlock>
                        </ListView.Header>
                    </ListView>
                    <Grid Grid.Row="2">
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Spacing="10">
                            <Button Content="Browse" Command="{x:Bind ViewModel.BrowseFolderCommand}" />
                            <Button Content="Remove" Command="{x:Bind ViewModel.RemoveFolderCommand}" />
                        </StackPanel>
                    </Grid>
                </Grid>
            </SelectorBarItem>

			<SelectorBarItem Text="Files">
                <StackPanel Spacing="12" Padding="8">
                    <TextBlock Foreground="Gray" TextWrapping="Wrap">Exclude specific files by providing their full path.</TextBlock>
                    <Grid RowSpacing="12">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="200" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <ListView Grid.Row="0"
                                  ItemsSource="{x:Bind ViewModel.ExcludeFiles, Mode=OneWay}"
                                  SelectedItem="{x:Bind ViewModel.SelectedFile, Mode=TwoWay}">
                            <ListView.Header>
                                <TextBlock FontWeight="Bold">File</TextBlock>
                            </ListView.Header>
                        </ListView>
                        <Grid Grid.Row="1">
                            <StackPanel Orientation="Horizontal" Spacing="10">
                                <Button Content="Browse" Command="{x:Bind ViewModel.BrowseFileCommand}" />
                                <Button Content="Remove" Command="{x:Bind ViewModel.RemoveFileCommand}" />
                            </StackPanel>
                        </Grid>
                    </Grid>
                </StackPanel>
            </SelectorBarItem>

			<SelectorBarItem Text="File types">
                <StackPanel Spacing="12" Padding="8">
                    <TextBlock Foreground="Gray" TextWrapping="Wrap">Exclude files by extension (e.g., tmp, log).</TextBlock>
                    <Grid RowSpacing="12">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="150" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <ListView Grid.Row="0"
                                  ItemsSource="{x:Bind ViewModel.ExcludeFileTypes, Mode=OneWay}"
                                  SelectedItem="{x:Bind ViewModel.SelectedFileType, Mode=TwoWay}">
                            <ListView.Header>
                                <TextBlock FontWeight="Bold">Extension</TextBlock>
                            </ListView.Header>
                        </ListView>
                        <Grid Grid.Row="1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <TextBox x:Name="FileTypeInput" PlaceholderText="Enter extension (without dot)" Margin="0,0,10,0" />
                            <StackPanel Orientation="Horizontal" Grid.Column="1" Spacing="10">
                                <Button Content="Add" Command="{x:Bind ViewModel.AddFileTypeCommand}" CommandParameter="{x:Bind FileTypeInput.Text}" />
                                <Button Content="Remove" Command="{x:Bind ViewModel.RemoveFileTypeCommand}" />
                            </StackPanel>
                        </Grid>
                    </Grid>
                </StackPanel>
            </SelectorBarItem>

			<SelectorBarItem Text="Regular expressions">
                <StackPanel Spacing="12" Padding="8">
                    <TextBlock Foreground="Gray" TextWrapping="Wrap">Exclude files or folders by matching regular expressions.</TextBlock>
                    <Grid RowSpacing="12">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="150" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <ListView Grid.Row="0"
                                  ItemsSource="{x:Bind ViewModel.RegexPatterns, Mode=OneWay}"
                                  SelectedItem="{x:Bind ViewModel.SelectedRegexPattern, Mode=TwoWay}">
                            <ListView.Header>
                                <TextBlock FontWeight="Bold">Pattern</TextBlock>
                            </ListView.Header>
                        </ListView>
                        <Grid Grid.Row="1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <TextBox x:Name="RegexInput" PlaceholderText="Enter regular expression" TextWrapping="Wrap" AcceptsReturn="True" Height="80" Margin="0,0,10,0" />
                            <StackPanel Orientation="Horizontal" Grid.Column="1" Spacing="10" VerticalAlignment="Top">
                                <Button Content="Add" Command="{x:Bind ViewModel.AddRegexCommand}" CommandParameter="{x:Bind RegexInput.Text}" />
                                <Button Content="Remove" Command="{x:Bind ViewModel.RemoveRegexCommand}" />
                            </StackPanel>
                        </Grid>
                    </Grid>
                </StackPanel>
            </SelectorBarItem>
	    </SelectorBar>

        <Grid Grid.Row="1" Background="#fafafa" Padding="30,10" BorderBrush="#f0f0f0" BorderThickness="0,1,0,0">
            <StackPanel Orientation="Horizontal" Spacing="10" HorizontalAlignment="Right">
                <Button Command="{x:Bind ViewModel.CancelCommand}">Cancel</Button>
                <Button Command="{x:Bind ViewModel.SaveCommand}" Style="{StaticResource AccentButtonStyle}">Save</Button>
            </StackPanel>
        </Grid>
    </Grid>
</winex:WindowEx>
